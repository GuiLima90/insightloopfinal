<%
  customer_names = [
    "Maria Silva", "Carlos Mendes", "João Santos",
    "Ana Costa", "Aline K.", "Diego Z.",
    "Eduardo N.", "Thiago B."
  ]

  fake_categories = ["Product Insight", "Questions", "Outros"]
%>

<div class="conversations-page">

  <%= link_to dashboard_path, class: "back-link" do %>
    <i class="fa-solid fa-arrow-left-long"></i>
  <% end %>

  <h1 class="conversations-title">Product Insights</h1>
  <h2 class="conversations-count">
    <%= @conversations.count %> Conversas no Total
  </h2>

  <% @conversations.each do |conversation| %>
    <div class="conversation-item">

      <!-- ESQUERDA -->
      <div class="conversation-left">

        <!-- AVATAR -->
        <div class="conversation-avatar">
          <%= customer_names[conversation.id % customer_names.size].first %>
        </div>

        <div class="conversation-content">

          <!-- NOME -->
          <p class="conversation-name">
            <%= customer_names[conversation.id % customer_names.size] %>
          </p>

          <!-- CATEGORIA (FICTÍCIA) -->
          <p class="conversation-subtitle">
            <%= fake_categories[conversation.id % fake_categories.size] %>
          </p>

          <!-- PREVIEW -->
          <p class="conversation-preview">
            <%= conversation.content
                  .to_s
                  .gsub(/\[.*?\]:/, "")
                  .strip
                  .truncate(120) %>
          </p>

        </div>
      </div>

      <!-- DIREITA (AÇÃO) -->
      <div class="conversation-right">
        <%= link_to product_insight_path(conversation),
              class: "conversation-arrow" do %>
          <i class="fa-solid fa-arrow-right-long"></i>
        <% end %>
      </div>

    </div>
  <% end %>

</div>
